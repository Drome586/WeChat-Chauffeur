<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.hxds.odr.db.dao.OrderCommentDao">

    <insert id="insert">
        INSERT INTO tb_order_comment
        SET order_id = #{orderId},
            driver_id = #{driverId},
            customer_id = #{customerId},
            rate = #{rate},
            remark = #{remark},
            status = #{status},
            instance_id = #{instanceId},
            create_time = #{createTime}
    </insert>
    <select id="searchCommentByOrderId" resultType="java.util.HashMap">
        SELECT CAST(id AS CHAR) AS id,
        CAST(driver_id AS CHAR) AS driverId,
        CAST(customer_id AS CHAR) AS customerId,
        rate,
        remark,
        `status`,
        instance_id AS instanceId,
        DATE_FORMAT(create_time, '%Y-%m-%d %H:%i:%s') AS createTime
        FROM tb_order_comment
        WHERE order_id = #{orderId}
        <if test="driverId!=null">
            AND driver_id = #{driverId}
        </if>
        <if test="customerId!=null">
            AND customer_id = #{customerId}
        </if>
    </select>
</mapper>
